!function(e,t){"function"==typeof define&&define.amd?define("ng-magics",["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):e["ng-magics"]=t(angular)}(this,function(e){var t={},n=function(){var t={},n=e,s=function(){function e(e){this.$delay=e,this.$cancel=function(){return clearTimeout(this.$timeout)}}function t(t,n,s){function i(){var e=arguments;void 0!==o.$timeout&&o.$cancel(),o.$timeout=setTimeout(function(){if("function"!=typeof s)return r(null,t,e);try{s(null,r(null,t,e))}catch(n){s(n)}},o.$delay)}2===arguments.length&&"function"==typeof n&&(s=n,n=void 0);var o=i;return e.call(o,n),o}function n(t,n,s){function i(){var e=arguments;if(void 0===o.$timeout){if(o.$timeout=setTimeout(function(){o.$timeout=void 0},o.$delay),"function"!=typeof s)return r(null,t,e);try{s(null,r(null,t,e))}catch(n){s(n)}}}2===arguments.length&&"function"==typeof n&&(s=n,n=void 0);var o=i;return e.call(o,n),o}var s={},r=function(){function e(e,t,n){var s=void 0===e||null===e,r=n?n.length:0;switch(r){case 0:return s?t():t.call(e);case 1:return s?t(n[0]):t.call(e,n[0]);case 2:return s?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return s?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return s?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3]);case 5:return s?t(n[0],n[1],n[2],n[3],n[4]):t.call(e,n[0],n[1],n[2],n[3],n[4]);case 6:return s?t(n[0],n[1],n[2],n[3],n[4],n[5]):t.call(e,n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return s?t(n[0],n[1],n[2],n[3],n[4],n[5],n[6]):t.call(e,n[0],n[1],n[2],n[3],n[4],n[5],n[6]);default:return s?t.apply(null,n):t.apply(e,n)}}var t={};return t=e}();return s.debounce=t,s.throttle=n,s}();return t.__esModule=!0,t["default"]=n.module("ngMagics.constants",[]).constant("debounce",s.debounce).constant("throttle",s.throttle).constant("scrollMagic",function(){return"undefined"!=typeof ScrollMagic?ScrollMagic:void 0}()).constant("Tween",function(){var e;return"undefined"!=typeof TweenMax?e=TweenMax:"undefined"!=typeof TweenLite?e=TweenLite:"undefined"!=typeof GreenSockGlobals&&(e=GreenSockGlobals.TweenMax||GreenSockGlobals.TweenLite),e}()).constant("tweenEasing",function(){return"undefined"!=typeof GreenSockGlobals?GreenSockGlobals.com.greensock.easing:void 0}()).name,t}(),s=function(){var t={},s=e,r=n,i=function(){function e(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];this.$={},this.debug=!1,this.debugOptions={},this.sceneOptions={},this.stageOptions={},this.pinOptions={},this.performanceOptions={brake:"debounce",delay:50};var r=this.constructor;s.forEach(r.$inject,function(n,s){e.$[n]=t[s]}),this.$get.$inject=o.$inject,this.scrollOptions={y:!0,duration:.75,ease:this.$.tweenEasing.Power2.easeInOut}}return e.prototype.$get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=Object.create(o.prototype);return o.apply(n,[this].concat(e)),n},e.$inject=["tweenEasing"],e}(),o=function(){function e(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.$={},this._scrollHandler=function(e,n){function s(){o.resolve(),c.$apply()}function r(){o.reject(),c.$apply()}var i=n[0],o=n[1],a=t.$,c=a.$rootScope,u=a.Tween,l=t._provider.scrollOptions,f={autoKill:!0,onAutoKill:r};l.x&&(f.x=e),l.y&&(f.y=e),u.to(i,l.duration,{scrollTo:f,ease:l.ease,onComplete:s})};var i=this.constructor;s.forEach(i.$inject,function(e,s){t.$[e]=n[s]}),this._provider=e;var o=this.$,a=o.$cacheFactory,c=o.debounce,u=o.throttle;this._brake="throttle"===this._provider.performanceOptions.brake?u:c,this._delay=this._provider.performanceOptions.delay;var l=a("magics");this._scenes=l.put("scenes",{}),this._stages=l.put("stages",{}),this.stage("default",{})}return e.prototype._isEmpty=function(e){return[null,void 0,""].indexOf(e)>=0},e.prototype._patch=function(e,t,n){var s=this;if("$$patched"in n)return n;var r=n.destroy;return n.destroy=function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];if("stage"===t&&"default"===e)return!0;var a="_"+t+"s";return delete s[a][e],r.apply(n,i)},n.$$patched=!0,n},e.prototype.stage=function(e,t){var n=this.$,r=n.$window,i=n.scrollMagic;if(this._isEmpty(e)&&(e="default"),e in this._stages)return this._stages[e];var o=s.extend({},this._provider.stageOptions,{globalSceneOptions:this._provider.sceneOptions,container:this._provider.container||r},t),a=this._stages[e]=new i.Controller(o);return a.scrollTo(this._scrollHandler),this._patch(e,"stage",a)},e.prototype.scene=function(e,t,n){var r=this.$,i=r.$rootScope,o=r.scrollMagic;if(e in this._scenes)return this._scenes[e];this._isEmpty(n)&&(n="default");var a=this._stages[n],c=this._scenes[e]=new o.Scene(t).addTo(a);return this._provider.debug&&c.addIndicators(s.extend({},this._provider.debugOptions,{name:e})),this.onSceneEnter(e,function(t){i.$broadcast("sceneEnter:"+e,t),i.$broadcast("sceneEnter",e,t)}),this.onSceneLeave(e,function(t){i.$broadcast("sceneLeave:"+e,t),i.$broadcast("sceneLeave",e,t)}),this._patch(e,"scene",c)},e.prototype.scrollToScene=function(e,t){var n=this.$,r=n.$q,i=n.scrollMagic;if(t=t||0,s.isString(e)&&(e=this._scenes[e]),!(e instanceof i.Scene))return!1;var o=e.scrollOffset()+t,a=e.controller(),c=a.info("container"),u=r.defer();return a.scrollTo(o,[c,u]),u.promise},e.prototype.onSceneEnter=function(e,t){var n=this,s=this._brake(t,this._delay);return this._scenes[e].on("enter.ngMagics",s),function(){var t=n._scenes[e];t&&t.off("enter.ngMagics",s)}},e.prototype.onSceneLeave=function(e,t){var n=this,s=this._brake(t,this._delay),r=this._scenes[e];return r.on("leave.ngMagics",s),function(){var t=n._scenes[e];t&&t.off("leave.ngMagics",s)}},e.prototype.onSceneProgress=function(e,t){var n=this,s=this._scenes[e];return s.on("progress.ngMagics",t),function(){var s=n._scenes[e];s&&s.off("progress.ngMagics",t)}},e.prototype.onSceneDestroy=function(e,t){var n=this,s=this._scenes[e];return s.on("destroy.ngMagics",t),function(){var s=n._scenes[e];s&&s.off("destroy.ngMagics",t)}},e.$inject=["$cacheFactory","$q","$rootScope","$window","debounce","throttle","scrollMagic","Tween"],e}();return t.__esModule=!0,t["default"]=s.module("ngMagics.magics",[r["default"]]).provider("magics",i).name,t}(),r=e,i=function(){var t={},n=e,r=s,i=function(){function e(){for(var e=this,t=[],s=0;s<arguments.length;s++)t[s-0]=arguments[s];this.$={};var r=this.constructor;n.forEach(r.$inject,function(n,s){e.$[n]=t[s]});var i=this.$,o=i.$scope,a=i.$element,c=i.$attrs,u=n.element.expando;this.sceneName=c.magicsScene||u+"."+a[0][u],this.sceneOptions=o.$eval(c.magicsSceneOptions)||{}}return e.prototype.init=function(e){var t=this,n=this.$,s=n.$element,r=n.magics;if(this.sceneName in r._scenes)return void(this.scene=r.scene(this.sceneName));if(this.scene=r.scene(this.sceneName,this.sceneOptions,e),!("duration"in this.sceneOptions)){var i=r.stage(e),o=s[0],a=i.info("vertical");this.scene.duration(function(){return a?o.offsetHeight:o.offsetWidth}),this.scene.triggerElement(o)}s.on("$destroy",function(){r.scene(t.sceneName).destroy()})},e.$inject=["$scope","$element","$attrs","$rootScope","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsScene",[r["default"]]).directive("magicsScene",function(){return{restrict:"A",require:["magicsScene","?^magicsStage"],controller:i,link:{pre:function(e,t,n,s){var r=s[0],i=s[1],o=(i||{}).stageName;r.init(o)}}}}).name,t}(),o=function(){var t={},n=e,r=s,i=function(){function e(){for(var e=this,t=[],s=0;s<arguments.length;s++)t[s-0]=arguments[s];this.$={};var r=this.constructor;n.forEach(r.$inject,function(n,s){e.$[n]=t[s]});var i=this.$,o=i.$scope,a=i.$attrs,c=i.$parse;if(a.magicsSpy){var u=c(a.magicsSpy).assign;u&&(this._flagSetter=function(e){return u(o,e)})}}return e.prototype.flag=function(e){return arguments.length&&(this._flag=e,this._flagSetter&&this._flagSetter(e)),this._flag},e.prototype.init=function(e){var t=this,n=this.$,s=n.$scope,r=n.$element,i=n.$attrs,o=n.magics,a=s.$eval(i.magicsSpyProgress);if(a){var c=o.onSceneProgress(e,a);r.on("$destroy",function(){return c()})}s.$on("sceneEnter:"+e,function(e){s.$apply(function(){return t.flag(!0)})}),s.$on("sceneLeave:"+e,function(e){s.$apply(function(){return t.flag(!1)})})},e.$inject=["$scope","$element","$attrs","$parse","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsSpy",[r["default"]]).directive("magicsSpy",["magics",function(e){return{restrict:"A",require:["magicsSpy","?^magicsScene"],controller:i,link:{pre:function(t,n,s,r){var i=r[0],o=r[1],a=(o||{}).sceneName,c=s.magicsSpyScene||a;e._isEmpty(c)||i.init(c)}}}}]).name,t}(),a=function(){var t={},n=e,r=s,i=function(){function e(){for(var e=this,t=[],s=0;s<arguments.length;s++)t[s-0]=arguments[s];this.$={};var r=this.constructor;n.forEach(r.$inject,function(n,s){e.$[n]=t[s]});var i=this.$,o=i.$scope,a=i.$attrs;this.stageName=a.magicsStage||"default",this.stageOptions=o.$eval(a.magicsStageOptions)||{}}return e.prototype.init=function(){var e=this,t=this.$,s=t.$element,r=t.magics;if(this.stageName in r._stages)return void(this.stage=r.stage(this.stageName));var i=n.extend({},this.stageOptions,{container:s[0]});this.stage=r.stage(this.stageName,i),s.on("$destroy",function(){r.stage(e.stageName).destroy()})},e.$inject=["$scope","$element","$attrs","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsStage",[r["default"]]).directive("magicsStage",function(){return{restrict:"A",controller:i,link:{pre:function(e,t,n,s){s.init()}}}}).name,t}(),c=n,u=s;return t.__esModule=!0,t["default"]=r.module("ngMagics",[i["default"],o["default"],a["default"],c["default"],u["default"]]).name,t});
//# sourceMappingURL=ng-magics.min.js.map
