!function(e,t){"function"==typeof define&&define.amd?define("ng-magics",["angular"],t):"object"==typeof exports?module.exports=t(require("angular")):e["ng-magics"]=t(angular)}(this,function(e){var t={},n=function(){var t={},n=e,r=function(){function e(e){this.$delay=e,this.$cancel=function(){return clearTimeout(this.$timeout)}}function t(t,n,r){function i(){var e=arguments;void 0!==o.$timeout&&o.$cancel(),o.$timeout=setTimeout(function(){if("function"!=typeof r)return s(null,t,e);try{r(null,s(null,t,e))}catch(n){r(n)}},o.$delay)}2===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var o=i;return e.call(o,n),o}function n(t,n,r){function i(){var e=arguments;if(void 0===o.$timeout){if(o.$timeout=setTimeout(function(){o.$timeout=void 0},o.$delay),"function"!=typeof r)return s(null,t,e);try{r(null,s(null,t,e))}catch(n){r(n)}}}2===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var o=i;return e.call(o,n),o}var r={},s=function(){function e(e,t,n){var r=void 0===e||null===e,s=n?n.length:0;switch(s){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3]);case 5:return r?t(n[0],n[1],n[2],n[3],n[4]):t.call(e,n[0],n[1],n[2],n[3],n[4]);case 6:return r?t(n[0],n[1],n[2],n[3],n[4],n[5]):t.call(e,n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return r?t(n[0],n[1],n[2],n[3],n[4],n[5],n[6]):t.call(e,n[0],n[1],n[2],n[3],n[4],n[5],n[6]);default:return r?t.apply(null,n):t.apply(e,n)}}var t={};return t=e}();return r.debounce=t,r.throttle=n,r}();return t.__esModule=!0,t["default"]=n.module("ngMagics.constants",[]).constant("debounce",r.debounce).constant("throttle",r.throttle).constant("scrollMagic",function(){return"undefined"!=typeof ScrollMagic?ScrollMagic:void 0}()).constant("Tween",function(){var e;return"undefined"!=typeof TweenMax?e=TweenMax:"undefined"!=typeof TweenLite?e=TweenLite:"undefined"!=typeof GreenSockGlobals&&(e=GreenSockGlobals.TweenMax||GreenSockGlobals.TweenLite),e}()).constant("tweenEasing",function(){return"undefined"!=typeof GreenSockGlobals?GreenSockGlobals.com.greensock.easing:void 0}()).name,t}(),r=function(){var t={},r=e,s=n,i=function(){function e(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];this.$={},this.debug=!1,this.debugOptions={},this.sceneOptions={},this.stageOptions={},this.pinOptions={},this.performanceOptions={brake:"debounce",delay:50};var s=this.constructor;r.forEach(s.$inject,function(n,r){e.$[n]=t[r]}),this.$get.$inject=o.$inject,this.scrollOptions={y:!0,duration:.75,ease:this.$.tweenEasing.Power2.easeInOut}}return e.prototype.$get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=Object.create(o.prototype);return o.apply(n,[this].concat(e)),n},e.$inject=["tweenEasing"],e}(),o=function(){function e(e){for(var t=this,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];this.$={},this._scrollHandler=function(e,n){function r(){o.resolve(),c.$apply()}function s(){o.reject(),c.$apply()}var i=n[0],o=n[1],a=t.$,c=a.$rootScope,u=a.Tween,l=t._provider.scrollOptions,f={autoKill:!0,onAutoKill:s};l.x&&(f.x=e),l.y&&(f.y=e),u.to(i,l.duration,{scrollTo:f,ease:l.ease,onComplete:r})};var i=this.constructor;r.forEach(i.$inject,function(e,r){t.$[e]=n[r]}),this._provider=e;var o=this.$,a=o.$cacheFactory,c=(o.debounce,o.throttle,a("magics"));this._scenes=c.put("scenes",{}),this._stages=c.put("stages",{}),this.stage("default",{})}return e.prototype._brake=function(e,t){var n,r=this._provider.performanceOptions.brake;return(n="throttle"===r?this.$.throttle:"debounce"===r?this.$.debounce:"function"==typeof r?r:function(e){return e})(e,t)},e.prototype._isEmpty=function(e){return[null,void 0,""].indexOf(e)>=0},e.prototype._onSceneBraked=function(e,t,n){var r=this,s=this._brake(n,this._provider.performanceOptions.delay);return this._scenes[t].on(e,s),function(){var n=r._scenes[t];n&&n.off(e,s)}},e.prototype._patch=function(e,t,n){var r=this;if("$$patched"in n)return n;var s=n.destroy;return n.destroy=function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];if("stage"===t&&"default"===e)return!0;var a="_"+t+"s";return delete r[a][e],s.apply(n,i)},n.$$patched=!0,n},e.prototype.stage=function(e,t){var n=this.$,s=n.$window,i=n.scrollMagic;if(this._isEmpty(e)&&(e="default"),e in this._stages)return this._stages[e];var o=r.extend({},this._provider.stageOptions,{container:this._provider.container||s},t);if("sceneOptions"in o){var a=o.sceneOptions;delete o.sceneOptions}var c=this._stages[e]=new i.Controller(o);return c._sceneOptions=a,c.scrollTo(this._scrollHandler),this._patch(e,"stage",c)},e.prototype.scene=function(e,t,n){var s=this.$,i=s.$rootScope,o=s.scrollMagic;if(e in this._scenes)return this._scenes[e];this._isEmpty(n)&&(n="default");var a=this._stages[n],c=r.extend({},this._provider.sceneOptions,a._sceneOptions,t),u=this._scenes[e]=new o.Scene(c).addTo(a);return this._provider.debug&&u.addIndicators(r.extend({},this._provider.debugOptions,{name:e})),this.onScene(e,function(t){i.$broadcast("scene:"+e,t),i.$broadcast("scene",e,t)}),this.onSceneEnter(e,function(t){i.$broadcast("sceneEnter:"+e,t),i.$broadcast("sceneEnter",e,t)}),this.onSceneLeave(e,function(t){i.$broadcast("sceneLeave:"+e,t),i.$broadcast("sceneLeave",e,t)}),this._patch(e,"scene",u)},e.prototype.scrollToScene=function(e,t){var n=this.$,s=n.$q,i=n.scrollMagic;if(t=t||0,r.isString(e)&&(e=this._scenes[e]),!(e instanceof i.Scene))return!1;var o=e.scrollOffset()+t,a=e.controller(),c=a.info("container"),u=s.defer();return a.scrollTo(o,[c,u]),u.promise},e.prototype.onScene=function(e,t){return this._onSceneBraked("enter.ngMagics leave.ngMagics",e,t)},e.prototype.onSceneEnter=function(e,t){return this._onSceneBraked("enter.ngMagics",e,t)},e.prototype.onSceneLeave=function(e,t){return this._onSceneBraked("leave.ngMagics",e,t)},e.prototype.onSceneProgress=function(e,t){var n=this,r=this._scenes[e];return r.on("progress.ngMagics",t),function(){var r=n._scenes[e];r&&r.off("progress.ngMagics",t)}},e.prototype.onSceneDestroy=function(e,t){var n=this,r=this._scenes[e];return r.on("destroy.ngMagics",t),function(){var r=n._scenes[e];r&&r.off("destroy.ngMagics",t)}},e.$inject=["$cacheFactory","$q","$rootScope","$window","debounce","throttle","scrollMagic","Tween"],e}();return t.__esModule=!0,t["default"]=r.module("ngMagics.magics",[s["default"]]).provider("magics",i).name,t}(),s=e,i=function(){var t={},n=e,s=r,i=function(){function e(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];this.$={};var s=this.constructor;n.forEach(s.$inject,function(n,r){e.$[n]=t[r]});var i=this.$,o=i.$scope,a=i.$element,c=i.$attrs,u=n.element.expando;this.sceneName=c.magicsScene||u+"."+a[0][u],this.sceneOptions=o.$eval(c.magicsSceneOptions)||{}}return e.prototype.init=function(e){var t=this,n=this.$,r=n.$element,s=n.magics;if(this.sceneName in s._scenes)return void(this.scene=s.scene(this.sceneName));this.scene=s.scene(this.sceneName,this.sceneOptions,e);var i=r[0];if(this.scene.triggerElement(i),!("duration"in this.sceneOptions)){var o=s.stage(e),a=o.info("vertical");this.scene.duration(function(){return a?i.offsetHeight:i.offsetWidth})}r.on("$destroy",function(){s.scene(t.sceneName).destroy()})},e.$inject=["$scope","$element","$attrs","$rootScope","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsScene",[s["default"]]).directive("magicsScene",function(){return{restrict:"A",require:["magicsScene","?^magicsStage"],controller:i,link:{pre:function(e,t,n,r){var s=r[0],i=r[1],o=(i||{}).stageName;s.init(o)}}}}).name,t}(),o=function(){var t={},n=e,s=r,i=function(){function e(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];this.$={};var s=this.constructor;n.forEach(s.$inject,function(n,r){e.$[n]=t[r]});var i=this.$,o=i.$scope,a=i.$attrs,c=i.$parse;if(a.magicsSpy){var u=c(a.magicsSpy).assign;u&&(this._flagSetter=function(e){return u(o,e)})}}return e.prototype.flag=function(e){return arguments.length&&(this._flag=e,this._flagSetter&&this._flagSetter(e)),this._flag},e.prototype.init=function(e){var t=this,n=this.$,r=n.$scope,s=n.$element,i=n.$attrs,o=n.magics,a=r.$eval(i.magicsSpyProgress);if(a){var c=o.onSceneProgress(e,a);s.on("$destroy",function(){return c()})}r.$on("scene:"+e,function(e,n){var s;"enter"===n.type?s=!0:"leave"===n.type&&(s=!1),r.$apply(function(){return t.flag(s)})})},e.$inject=["$scope","$element","$attrs","$parse","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsSpy",[s["default"]]).directive("magicsSpy",["magics",function(e){return{restrict:"A",require:["magicsSpy","?^magicsScene"],controller:i,link:{pre:function(t,n,r,s){var i=s[0],o=s[1],a=(o||{}).sceneName,c=r.magicsSpyScene||a;e._isEmpty(c)||i.init(c)}}}}]).name,t}(),a=function(){var t={},n=e,s=r,i=function(){function e(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r-0]=arguments[r];this.$={};var s=this.constructor;n.forEach(s.$inject,function(n,r){e.$[n]=t[r]});var i=this.$,o=i.$scope,a=i.$attrs;this.stageName=a.magicsStage||"default",this.stageOptions=o.$eval(a.magicsStageOptions)||{}}return e.prototype.init=function(){var e=this,t=this.$,r=t.$element,s=t.magics;if(this.stageName in s._stages)return void(this.stage=s.stage(this.stageName));var i=n.extend({},this.stageOptions,{container:r[0]});this.stage=s.stage(this.stageName,i),r.on("$destroy",function(){s.stage(e.stageName).destroy()})},e.$inject=["$scope","$element","$attrs","magics"],e}();return t.__esModule=!0,t["default"]=n.module("ngMagics.magicsStage",[s["default"]]).directive("magicsStage",function(){return{restrict:"A",controller:i,link:{pre:function(e,t,n,r){r.init()}}}}).name,t}(),c=n,u=r;return t.__esModule=!0,t["default"]=s.module("ngMagics",[i["default"],o["default"],a["default"],c["default"],u["default"]]).name,t});
//# sourceMappingURL=ng-magics.min.js.map
