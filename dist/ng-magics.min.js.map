{"version":3,"sources":["ng-magics.js"],"names":["__root","__factory","define","amd","exports","module","require","angular","this","__small$_mod_0","__small$_4","debottle_1","Debottle","delay","$delay","$cancel","clearTimeout","$timeout","debounce","fn","cb","debouncedFn","args","arguments","undefined","self","setTimeout","apply","e","length","call","throttle","throttledFn","selfless","__esModule","constant","ScrollMagic","Tween","TweenMax","TweenLite","GreenSockGlobals","com","greensock","easing","name","__small$_5","constants_1","MagicsProvider","_this","deps","_i","$","debug","debugOptions","sceneOptions","stageOptions","pinOptions","performanceOptions","brake","constructor","forEach","$inject","depName","i","$get","MagicsInstance","scrollOptions","y","duration","ease","tweenEasing","Power2","easeInOut","prototype","instance","Object","create","concat","provider","_scrollHandler","target","_a","completeHandler","deferred","resolve","$rootScope","$apply","autoKillHandler","reject","container","_b","_provider","scrollToOptions","autoKill","onAutoKill","x","to","scrollTo","onComplete","$cacheFactory","cache","_scenes","put","_stages","stage","_brake","handler","brakeOption","_isEmpty","val","indexOf","_onSceneBraked","eventName","brakedHandler","on","scene","off","_patch","type","destroy_","destroy","storageName","$$patched","options","$window","scrollMagic","extend","Controller","_sceneOptions","stageName","Scene","addTo","addIndicators","onScene","$broadcast","onSceneEnter","onSceneLeave","scrollToScene","offset","$q","isString","scrollOffset","controller","info","defer","promise","onSceneProgress","onSceneDestroy","magics_scene_1","magics_1","MagicsSceneDirectiveController","$scope","$element","$attrs","expando","element","sceneName","magicsScene","$eval","magicsSceneOptions","init","magics","triggerElement","isVertical","offsetHeight","offsetWidth","directive","restrict","link","pre","scope","attrs","ctrls","sceneCtrl","stageCtrl","magics_spy_1","MagicsSpyDirectiveController","$parse","magicsSpy","setter","assign","_flagSetter","flag","_flag","progressHandler","magicsSpyProgress","offSceneProgress","$on","$e","state","spyCtrl","parentSceneName","magicsSpyScene","magics_stage_1","MagicsStageDirectiveController","magicsStage","magicsStageOptions","ctrl"],"mappings":"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","file":"ng-magics.min.js","sourcesContent":["(function(__root, __factory) { if (typeof define === \"function\" && define.amd) { define(\"ng-magics\", [\"angular\"], __factory);} else if (typeof exports === \"object\") {module.exports = __factory(require(\"angular\"));} else {__root[\"ng-magics\"] = __factory(angular);}})(this, (function(__small$_mod_0) {\nvar exports = {};\nvar __small$_4 = (function() {\nvar exports = {};\n/// <reference path=\"../typings/globals.d.ts\"/>\n/// <reference path=\"../typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar debottle_1 = ((function() {\nvar exports = {};\nvar apply = ((function() {\nvar exports = {};\nfunction apply(self, fn, args) {\r\n\tvar selfless = (self === undefined) || (self === null);\r\n\tvar length = args ? args.length : 0;\r\n\t\r\n\tswitch (length) {\r\n\t\tcase 0:\r\n\t\t\treturn selfless ? fn() : fn.call(self);\r\n\t\tcase 1:\r\n\t\t\treturn selfless ? fn(args[0]) : fn.call(self, args[0]);\r\n\t\tcase 2:\r\n\t\t\treturn selfless ? fn(args[0], args[1]) : fn.call(self, args[0], args[1]);\r\n\t\tcase 3:\r\n\t\t\treturn selfless ? fn(args[0], args[1], args[2]) : fn.call(self, args[0], args[1], args[2]);\r\n\t\tcase 4:\r\n\t\t\treturn selfless ? fn(args[0], args[1], args[2], args[3]) : fn.call(self, args[0], args[1], args[2], args[3]);\r\n\t\tcase 5:\r\n\t\t\treturn selfless ? fn(args[0], args[1], args[2], args[3], args[4]) : fn.call(self, args[0], args[1], args[2], args[3], args[4]);\r\n\t\tcase 6:\r\n\t\t\treturn selfless ? fn(args[0], args[1], args[2], args[3], args[4], args[5]) : fn.call(self, args[0], args[1], args[2], args[3], args[4], args[5]);\r\n\t\t// the crucial point\r\n\t\tcase 7:\r\n\t\t\treturn selfless ? fn(args[0], args[1], args[2], args[3], args[4], args[5], args[6]) : fn.call(self, args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\r\n\t\tdefault:\r\n\t\t\treturn selfless ? fn.apply(null, args) : fn.apply(self, args);\r\n\t}\r\n}\r\n\r\nexports = apply;\nreturn exports;\n})());\r\n\r\nfunction Debottle(delay) {\r\n\tthis.$delay = delay;\r\n\r\n\tthis.$cancel = function () {\r\n\t\treturn clearTimeout(this.$timeout);\r\n\t}\r\n}\r\n\r\nfunction debounce(fn, delay, cb) {\r\n\tif (arguments.length === 2 && typeof delay === 'function') {\r\n\t\tcb = delay;\r\n\t\tdelay = undefined;\r\n\t}\r\n\r\n\tvar self = debouncedFn;\r\n\tDebottle.call(self, delay);\r\n\r\n\tfunction debouncedFn() {\r\n\t\tvar args = arguments;\r\n\r\n\t\tif (self.$timeout !== undefined)\r\n\t\t\tself.$cancel();\r\n\r\n\t\tself.$timeout = setTimeout(function () {\r\n\t\t\tif (typeof cb !== 'function')\r\n\t\t\t\treturn apply(null, fn, args);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tcb(null, apply(null, fn, args));\r\n\t\t\t} catch (e)\t{\r\n\t\t\t\tcb(e);\r\n\t\t\t}\r\n\t\t}, self.$delay);\r\n\t};\r\n\r\n\treturn self;\r\n}\r\n\r\nfunction throttle(fn, delay, cb) {\r\n\tif (arguments.length === 2 && typeof delay === 'function') {\r\n\t\tcb = delay;\r\n\t\tdelay = undefined;\r\n\t}\r\n\r\n\tvar self = throttledFn;\r\n\tDebottle.call(self, delay);\r\n\r\n\tfunction throttledFn() {\r\n\t\tvar args = arguments;\r\n\r\n\t\tif (self.$timeout !== undefined)\r\n\t\t\treturn;\r\n\r\n\t\tself.$timeout = setTimeout(function () {\r\n\t\t\tself.$timeout = undefined;\r\n\t\t}, self.$delay);\r\n\r\n\t\tif (typeof cb !== 'function')\r\n\t\t\treturn apply(null, fn, args);\r\n\r\n\t\ttry {\r\n\t\t\tcb(null, apply(null, fn, args));\r\n\t\t} catch (e)\t{\r\n\t\t\tcb(e);\r\n\t\t}\r\n\t};\r\n\r\n\treturn self;\r\n}\r\n\r\nexports.debounce = debounce;\r\nexports.throttle = throttle;\r\n\nreturn exports;\n})());\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics.constants', [])\n    .constant('debounce', debottle_1.debounce)\n    .constant('throttle', debottle_1.throttle)\n    .constant('scrollMagic', (function () {\n    if (typeof ScrollMagic !== 'undefined') {\n        return ScrollMagic;\n    }\n})())\n    .constant('Tween', (function () {\n    var Tween;\n    // module bundler global substitution\n    if (typeof TweenMax !== 'undefined') {\n        Tween = TweenMax;\n    }\n    else if (typeof TweenLite !== 'undefined') {\n        Tween = TweenLite;\n    }\n    else if (typeof GreenSockGlobals !== 'undefined') {\n        Tween = GreenSockGlobals.TweenMax || GreenSockGlobals.TweenLite;\n    }\n    return Tween;\n})())\n    .constant('tweenEasing', (function () {\n    if (typeof GreenSockGlobals !== 'undefined') {\n        return GreenSockGlobals.com.greensock.easing;\n    }\n})())\n    .name;\n\nreturn exports;\n})();\nvar __small$_5 = (function() {\nvar exports = {};\n/// <reference path=\"../typings/globals.d.ts\"/>\n/// <reference path=\"../typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar constants_1 = __small$_4;\nvar MagicsProvider = (function () {\n    function MagicsProvider() {\n        var _this = this;\n        var deps = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            deps[_i - 0] = arguments[_i];\n        }\n        this.$ = {};\n        this.debug = false;\n        this.debugOptions = {};\n        this.sceneOptions = {};\n        this.stageOptions = {};\n        this.pinOptions = {};\n        this.performanceOptions = {\n            brake: 'debounce',\n            delay: 50\n        };\n        var self = this.constructor;\n        angular.forEach(self.$inject, function (depName, i) {\n            _this.$[depName] = deps[i];\n        });\n        // TODO: proper typing\n        this.$get.$inject = MagicsInstance.$inject;\n        this.scrollOptions = {\n            y: true,\n            duration: 0.75,\n            ease: this.$.tweenEasing.Power2.easeInOut\n        };\n    }\n    MagicsProvider.prototype.$get = function () {\n        var deps = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            deps[_i - 0] = arguments[_i];\n        }\n        var instance = Object.create(MagicsInstance.prototype);\n        MagicsInstance.apply(instance, [this].concat(deps));\n        return instance;\n    };\n    MagicsProvider.$inject = ['tweenEasing'];\n    return MagicsProvider;\n})();\nvar MagicsInstance = (function () {\n    function MagicsInstance(provider) {\n        var _this = this;\n        var deps = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            deps[_i - 1] = arguments[_i];\n        }\n        this.$ = {};\n        // TODO: swappable method\n        // stage.scrollTo accepts 1 optional argument\n        this._scrollHandler = function (target, _a) {\n            var container = _a[0], deferred = _a[1];\n            var _b = _this.$, $rootScope = _b.$rootScope, Tween = _b.Tween;\n            var scrollOptions = _this._provider.scrollOptions;\n            function completeHandler() {\n                deferred.resolve();\n                $rootScope.$apply();\n            }\n            function autoKillHandler() {\n                deferred.reject();\n                $rootScope.$apply();\n            }\n            var scrollToOptions = {\n                autoKill: true,\n                onAutoKill: autoKillHandler\n            };\n            if (scrollOptions.x) {\n                scrollToOptions.x = target;\n            }\n            if (scrollOptions.y) {\n                scrollToOptions.y = target;\n            }\n            Tween.to(container, scrollOptions.duration, {\n                scrollTo: scrollToOptions,\n                ease: scrollOptions.ease,\n                onComplete: completeHandler\n            });\n        };\n        var self = this.constructor;\n        angular.forEach(self.$inject, function (depName, i) {\n            _this.$[depName] = deps[i];\n        });\n        this._provider = provider;\n        //\n        var _a = this.$, $cacheFactory = _a.$cacheFactory, debounce = _a.debounce, throttle = _a.throttle;\n        var cache = $cacheFactory('magics');\n        this._scenes = cache.put('scenes', {});\n        this._stages = cache.put('stages', {});\n        this.stage('default', {});\n    }\n    // TODO: test _brake\n    MagicsInstance.prototype._brake = function (handler, delay) {\n        var brake;\n        var brakeOption = this._provider.performanceOptions.brake;\n        if (brakeOption === 'throttle') {\n            brake = this.$.throttle;\n        }\n        else if (brakeOption === 'debounce') {\n            brake = this.$.debounce;\n        }\n        else if (typeof brakeOption === 'function') {\n            brake = brakeOption;\n        }\n        else {\n            brake = function (handler) { return handler; };\n        }\n        return brake(handler, delay);\n    };\n    MagicsInstance.prototype._isEmpty = function (val) {\n        return ([null, undefined, ''].indexOf(val) >= 0);\n    };\n    // TODO: test _onSceneBraked\n    MagicsInstance.prototype._onSceneBraked = function (eventName, name, handler) {\n        var _this = this;\n        var brakedHandler = this._brake(handler, this._provider.performanceOptions.delay);\n        this._scenes[name].on(eventName, brakedHandler);\n        return function () {\n            var scene = _this._scenes[name];\n            if (scene) {\n                scene.off(eventName, brakedHandler);\n            }\n        };\n    };\n    MagicsInstance.prototype._patch = function (name, type, instance) {\n        var _this = this;\n        if ('$$patched' in instance) {\n            return instance;\n        }\n        var destroy_ = instance.destroy;\n        instance.destroy = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i - 0] = arguments[_i];\n            }\n            if (type === 'stage' && name === 'default') {\n                // original .destroy() return null\n                return true;\n            }\n            // handling stage/scene name is not possible when decorating with .extend()\n            var storageName = '_' + type + 's';\n            delete _this[storageName][name];\n            return destroy_.apply(instance, args);\n        };\n        instance.$$patched = true;\n        return instance;\n    };\n    MagicsInstance.prototype.stage = function (name, options) {\n        var _a = this.$, $window = _a.$window, scrollMagic = _a.scrollMagic;\n        if (this._isEmpty(name)) {\n            name = 'default';\n        }\n        // TODO: duplicate warning for 'options'\n        if (name in this._stages) {\n            return this._stages[name];\n        }\n        var stageOptions = angular.extend({}, this._provider.stageOptions, {\n            // TODO: custom container\t\n            container: this._provider.container || $window\n        }, options);\n        // TODO?: refactor to ScrollMagic API\n        if ('sceneOptions' in stageOptions) {\n            var sceneOptions = stageOptions.sceneOptions;\n            delete stageOptions.sceneOptions;\n        }\n        var stage = this._stages[name] = new scrollMagic.Controller(stageOptions);\n        stage._sceneOptions = sceneOptions;\n        stage.scrollTo(this._scrollHandler);\n        return this._patch(name, 'stage', stage);\n    };\n    MagicsInstance.prototype.scene = function (name, options, stageName) {\n        var _a = this.$, $rootScope = _a.$rootScope, scrollMagic = _a.scrollMagic;\n        // TODO: duplicate warning for 'options'\n        if (name in this._scenes) {\n            return this._scenes[name];\n        }\n        if (this._isEmpty(stageName)) {\n            stageName = 'default';\n        }\n        var stage = this._stages[stageName];\n        // TODO: test sceneOptions\n        var sceneOptions = angular.extend({}, this._provider.sceneOptions, stage._sceneOptions, options);\n        var scene = this._scenes[name] = (new scrollMagic.Scene(sceneOptions)).addTo(stage);\n        if (this._provider.debug) {\n            scene.addIndicators(angular.extend({}, this._provider.debugOptions, {\n                name: name\n            }));\n        }\n        this.onScene(name, function (e) {\n            $rootScope.$broadcast('scene:' + name, e);\n            $rootScope.$broadcast('scene', name, e);\n        });\n        this.onSceneEnter(name, function (e) {\n            $rootScope.$broadcast('sceneEnter:' + name, e);\n            $rootScope.$broadcast('sceneEnter', name, e);\n        });\n        this.onSceneLeave(name, function (e) {\n            $rootScope.$broadcast('sceneLeave:' + name, e);\n            $rootScope.$broadcast('sceneLeave', name, e);\n        });\n        return this._patch(name, 'scene', scene);\n    };\n    MagicsInstance.prototype.scrollToScene = function (scene, offset) {\n        var _a = this.$, $q = _a.$q, scrollMagic = _a.scrollMagic;\n        offset = offset || 0;\n        if (angular.isString(scene)) {\n            scene = this._scenes[scene];\n        }\n        if (!(scene instanceof scrollMagic.Scene)) {\n            return false;\n        }\n        var target = scene.scrollOffset() + offset;\n        var stage = scene.controller();\n        var container = stage.info('container');\n        var deferred = $q.defer();\n        // the proper use case for Deferred, one and only\n        stage.scrollTo(target, [container, deferred]);\n        return deferred.promise;\n    };\n    // TODO: ? stage namespacing, brake per stage\n    // TODO: additional params\n    MagicsInstance.prototype.onScene = function (name, handler) {\n        return this._onSceneBraked('enter.ngMagics leave.ngMagics', name, handler);\n    };\n    MagicsInstance.prototype.onSceneEnter = function (name, handler) {\n        return this._onSceneBraked('enter.ngMagics', name, handler);\n    };\n    MagicsInstance.prototype.onSceneLeave = function (name, handler) {\n        return this._onSceneBraked('leave.ngMagics', name, handler);\n    };\n    // TODO: onScenePoint\n    MagicsInstance.prototype.onSceneProgress = function (name, handler) {\n        var _this = this;\n        var scene = this._scenes[name];\n        scene.on('progress.ngMagics', handler);\n        return function () {\n            var scene = _this._scenes[name];\n            if (scene) {\n                scene.off('progress.ngMagics', handler);\n            }\n        };\n    };\n    MagicsInstance.prototype.onSceneDestroy = function (name, handler) {\n        var _this = this;\n        var scene = this._scenes[name];\n        scene.on('destroy.ngMagics', handler);\n        return function () {\n            var scene = _this._scenes[name];\n            if (scene) {\n                scene.off('destroy.ngMagics', handler);\n            }\n        };\n    };\n    MagicsInstance.$inject = ['$cacheFactory', '$q', '$rootScope', '$window', 'debounce', 'throttle', 'scrollMagic', 'Tween'];\n    return MagicsInstance;\n})();\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics.magics', [constants_1[\"default\"]])\n    .provider('magics', MagicsProvider)\n    .name;\n\nreturn exports;\n})();\n/// <reference path=\"./typings/globals.d.ts\"/>\n/// <reference path=\"./typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar magics_scene_1 = ((function() {\nvar exports = {};\n/// <reference path=\"../typings/globals.d.ts\"/>\n/// <reference path=\"../typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar magics_1 = __small$_5;\nvar MagicsSceneDirectiveController = (function () {\n    function MagicsSceneDirectiveController() {\n        var _this = this;\n        var deps = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            deps[_i - 0] = arguments[_i];\n        }\n        this.$ = {};\n        var self = this.constructor;\n        angular.forEach(self.$inject, function (depName, i) {\n            _this.$[depName] = deps[i];\n        });\n        //\n        var _a = this.$, $scope = _a.$scope, $element = _a.$element, $attrs = _a.$attrs;\n        var expando = angular.element.expando;\n        // TODO: global option to get scene name from 'id' attr\n        // uninterpolated attribute\n        this.sceneName = $attrs.magicsScene || (expando + '.' + $element[0][expando]);\n        // TODO: filter duration, offset, triggerHook, reverse\n        this.sceneOptions = $scope.$eval($attrs.magicsSceneOptions) || {};\n    }\n    MagicsSceneDirectiveController.prototype.init = function (stageName) {\n        var _this = this;\n        var _a = this.$, $element = _a.$element, magics = _a.magics;\n        // TODO: avoid _scenes check\n        // TODO: duplicate warning\n        if (this.sceneName in magics._scenes) {\n            this.scene = magics.scene(this.sceneName);\n            return;\n        }\n        this.scene = magics.scene(this.sceneName, this.sceneOptions, stageName);\n        var element = $element[0];\n        // TODO: spec\n        this.scene.triggerElement(element);\n        if (!('duration' in this.sceneOptions)) {\n            // TODO: ? stage property\n            var stage = magics.stage(stageName);\n            var isVertical = stage.info('vertical');\n            // TODO: ? separate method\n            this.scene.duration(function () {\n                // TODO: caching\n                return isVertical ? element.offsetHeight : element.offsetWidth;\n            });\n        }\n        $element.on('$destroy', function () {\n            magics.scene(_this.sceneName).destroy();\n        });\n    };\n    MagicsSceneDirectiveController.$inject = ['$scope', '$element', '$attrs', '$rootScope', 'magics'];\n    return MagicsSceneDirectiveController;\n})();\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics.magicsScene', [magics_1[\"default\"]])\n    .directive('magicsScene', function () { return ({\n    /**\n     * @ngdoc directive\n     * @name magicsScene\n     *\n     * @element ANY\n     * @restrict A\n     *\n     * @param {string=} magicsScene Scene name.\n     * @param {Object=} magicsSceneOptions Options that are used on scene creation.\n     *\n     * @description Creates a new scene or reuses the existing one\n     * on either the stage specified by `magicsStage` directive or 'default' stage.\n     */\n    restrict: 'A',\n    require: ['magicsScene', '?^magicsStage'],\n    controller: MagicsSceneDirectiveController,\n    link: {\n        pre: function (scope, element, attrs, ctrls) {\n            var sceneCtrl = ctrls[0], stageCtrl = ctrls[1];\n            var stageName = (stageCtrl || {}).stageName;\n            sceneCtrl.init(stageName);\n        }\n    }\n}); })\n    .name;\n\nreturn exports;\n})());\nvar magics_spy_1 = ((function() {\nvar exports = {};\n/// <reference path=\"../typings/globals.d.ts\"/>\n/// <reference path=\"../typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar magics_1 = __small$_5;\nvar MagicsSpyDirectiveController = (function () {\n    function MagicsSpyDirectiveController() {\n        var _this = this;\n        var deps = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            deps[_i - 0] = arguments[_i];\n        }\n        this.$ = {};\n        var self = this.constructor;\n        angular.forEach(self.$inject, function (depName, i) {\n            _this.$[depName] = deps[i];\n        });\n        //\n        var _a = this.$, $scope = _a.$scope, $attrs = _a.$attrs, $parse = _a.$parse;\n        // uninterpolated attribute\n        if ($attrs.magicsSpy) {\n            var setter = $parse($attrs.magicsSpy).assign;\n            if (setter) {\n                this._flagSetter = function (val) { return setter($scope, val); };\n            }\n        }\n    }\n    // TODO: get/set\n    MagicsSpyDirectiveController.prototype.flag = function (val) {\n        if (arguments.length) {\n            this._flag = val;\n            if (this._flagSetter) {\n                this._flagSetter(val);\n            }\n        }\n        return this._flag;\n    };\n    MagicsSpyDirectiveController.prototype.init = function (sceneName) {\n        var _this = this;\n        var _a = this.$, $scope = _a.$scope, $element = _a.$element, $attrs = _a.$attrs, magics = _a.magics;\n        var progressHandler = $scope.$eval($attrs.magicsSpyProgress);\n        if (progressHandler) {\n            var offSceneProgress = magics.onSceneProgress(sceneName, progressHandler);\n            $element.on('$destroy', function () { return offSceneProgress(); });\n        }\n        // TODO: ? $rootScope\n        $scope.$on('scene:' + sceneName, function ($e, e) {\n            var state;\n            if (e.type === 'enter') {\n                state = true;\n            }\n            else if (e.type === 'leave') {\n                state = false;\n            }\n            $scope.$apply(function () { return _this.flag(state); });\n        });\n    };\n    MagicsSpyDirectiveController.$inject = ['$scope', '$element', '$attrs', '$parse', 'magics'];\n    return MagicsSpyDirectiveController;\n})();\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics.magicsSpy', [magics_1[\"default\"]])\n    .directive('magicsSpy', ['magics', function (magics) { return ({\n        /**\n         * @ngdoc directive\n         * @name magicsSpy\n         *\n         * @element ANY\n         * @restrict A\n         *\n         * @param {expression=} magicsSpy Scope variable flag *(read-only)*.\n         * @param {string=} magicsSpyScene Scene name.\n         * @param {expression=} magicsSpyProgress Scene progress callback function.\n         *\n         * @description Sets up a spy for the scene specified\n         *  by either parent `magicsScene` directive or `magicsSpyScene` attribute.\n         */\n        restrict: 'A',\n        require: ['magicsSpy', '?^magicsScene'],\n        controller: MagicsSpyDirectiveController,\n        link: {\n            pre: function (scope, element, attrs, ctrls) {\n                var spyCtrl = ctrls[0], sceneCtrl = ctrls[1];\n                var parentSceneName = (sceneCtrl || {}).sceneName;\n                var sceneName = attrs.magicsSpyScene || parentSceneName;\n                if (magics._isEmpty(sceneName)) {\n                    return;\n                }\n                spyCtrl.init(sceneName);\n            }\n        }\n    }); }])\n    .name;\n\nreturn exports;\n})());\nvar magics_stage_1 = ((function() {\nvar exports = {};\n/// <reference path=\"../typings/globals.d.ts\"/>\n/// <reference path=\"../typings/lib.d.ts\"/>\nvar angular = __small$_mod_0;\nvar magics_1 = __small$_5;\nvar MagicsStageDirectiveController = (function () {\n    function MagicsStageDirectiveController() {\n        var _this = this;\n        var deps = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            deps[_i - 0] = arguments[_i];\n        }\n        this.$ = {};\n        var self = this.constructor;\n        angular.forEach(self.$inject, function (depName, i) {\n            _this.$[depName] = deps[i];\n        });\n        //\n        var _a = this.$, $scope = _a.$scope, $attrs = _a.$attrs;\n        // uninterpolated attribute\n        this.stageName = $attrs.magicsStage || 'default';\n        // TODO: filter vertical, refreshInterval\n        this.stageOptions = $scope.$eval($attrs.magicsStageOptions) || {};\n        // TODO: custom scrollTo function\n    }\n    MagicsStageDirectiveController.prototype.init = function () {\n        var _this = this;\n        var _a = this.$, $element = _a.$element, magics = _a.magics;\n        // TODO: avoid _stages check\n        // TODO: duplicate warning\n        if (this.stageName in magics._stages) {\n            this.stage = magics.stage(this.stageName);\n            return;\n        }\n        var stageOptions = angular.extend({}, this.stageOptions, { container: $element[0] });\n        this.stage = magics.stage(this.stageName, stageOptions);\n        // TODO: ? scope on destroy\n        $element.on('$destroy', function () {\n            magics.stage(_this.stageName).destroy();\n        });\n    };\n    MagicsStageDirectiveController.$inject = ['$scope', '$element', '$attrs', 'magics'];\n    return MagicsStageDirectiveController;\n})();\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics.magicsStage', [magics_1[\"default\"]])\n    .directive('magicsStage', function () { return ({\n    /**\n     * @ngdoc directive\n     * @name magicsStage\n     *\n     * @element ANY\n     * @restrict A\n     *\n     * @param {string=} magicsStage Stage name.\n     * @param {Object=} magicsStageOptions Options that have to be passed  to `magics.stage`.\n     *\n     * @description Creates a new stage or reuses the existing one.\n     */\n    restrict: 'A',\n    controller: MagicsStageDirectiveController,\n    link: {\n        pre: function (scope, element, attrs, ctrl) {\n            ctrl.init();\n        }\n    }\n}); })\n    .name;\n\nreturn exports;\n})());\nvar constants_1 = __small$_4;\nvar magics_1 = __small$_5;\nexports.__esModule = true;\nexports[\"default\"] = angular.module('ngMagics', [\n    magics_scene_1[\"default\"],\n    magics_spy_1[\"default\"],\n    magics_stage_1[\"default\"],\n    constants_1[\"default\"],\n    magics_1[\"default\"]\n])\n    .name;\n\nreturn exports;\n}))"],"sourceRoot":"/source/"}